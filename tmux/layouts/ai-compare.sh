#!/usr/bin/env bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AI Compare Layout for Tmux
# Created for Frank Yang - VibeGhostty Project
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Layout Design:
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  Codex CLI     â”‚  Claude Code   â”‚
# â”‚  50%           â”‚  50%           â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  Compare/Monitor (25%)          â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# Usage:
#   ./ai-compare.sh [project_dir]
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -e

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Configuration
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SESSION_NAME="ai-compare"
PROJECT_DIR="${1:-$PWD}"

if [[ ! -d "$PROJECT_DIR" ]]; then
    echo "âŒ éŒ¯èª¤ï¼šå°ˆæ¡ˆç›®éŒ„ä¸å­˜åœ¨ '$PROJECT_DIR'"
    exit 1
fi

if [[ -d "$PROJECT_DIR/.git" ]]; then
    REPO_NAME=$(basename "$PROJECT_DIR")
    SESSION_NAME="compare-${REPO_NAME}"
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Check existing session
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

if tmux has-session -t "$SESSION_NAME" 2>/dev/null; then
    echo "ğŸ“Œ Session '$SESSION_NAME' å·²å­˜åœ¨"
    read -p "é€£æ¥åˆ°ç¾æœ‰ session? [Y/n]: " choice
    case $choice in
        n|N)
            echo "ğŸ—‘ï¸  åˆªé™¤ä¸¦é‡æ–°å»ºç«‹..."
            tmux kill-session -t "$SESSION_NAME"
            ;;
        *)
            echo "ğŸ”— é€£æ¥ä¸­..."
            tmux attach-session -t "$SESSION_NAME"
            exit 0
            ;;
    esac
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Create new session
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "ğŸš€ å»ºç«‹ AI Compare session: $SESSION_NAME"
echo "ğŸ“ å°ˆæ¡ˆç›®éŒ„: $PROJECT_DIR"

tmux new-session -d -s "$SESSION_NAME" -c "$PROJECT_DIR"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Pane 0: Codex CLI (å·¦å´ 50%)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

tmux select-pane -t 0 -T "ğŸ”§ Codex CLI"
tmux send-keys -t "$SESSION_NAME:0.0" "codex" C-m

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Pane 1: Claude Code (å³å´ 50%)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

tmux split-window -h -p 50 -t "$SESSION_NAME:0" -c "$PROJECT_DIR"
tmux select-pane -t 1 -T "ğŸ¤– Claude Code"
tmux send-keys -t "$SESSION_NAME:0.1" "claude" C-m

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Pane 2: Compare/Monitor (ä¸‹æ–¹ 25%)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# é¸æ“‡ pane 0ï¼Œåœ¨ä¸‹æ–¹åˆ†å‰²
tmux select-pane -t 0
tmux split-window -v -p 25 -t "$SESSION_NAME:0.0" -c "$PROJECT_DIR"
tmux select-pane -t 2 -T "âš–ï¸  Compare"

# é¡¯ç¤ºæç¤º
tmux send-keys -t "$SESSION_NAME:0.2" "clear" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo ''" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo 'â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo 'â•‘     âš–ï¸  Compare Pane ä½¿ç”¨èªªæ˜            â•‘'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo 'â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo ''" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo 'æ­¤æ¨¡å¼ç”¨æ–¼æ¯”è¼ƒå…©å€‹ AI çš„è¼¸å‡ºï¼š'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo ''" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo '  ğŸ“ æ¯”è¼ƒç¨‹å¼ç¢¼é¢¨æ ¼'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo '  ğŸ” æ¯”è¼ƒè§£æ±ºæ–¹æ¡ˆå“è³ª'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo '  âš¡ æ¯”è¼ƒåŸ·è¡Œæ•ˆèƒ½'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo '  ğŸ§ª åŸ·è¡Œæ¸¬è©¦é©—è­‰'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo ''" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo 'å¸¸ç”¨æŒ‡ä»¤ï¼š'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo '  diff output1.txt output2.txt'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo '  git diff branch1 branch2'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo '  vimdiff file1 file2'" C-m
tmux send-keys -t "$SESSION_NAME:0.2" "echo ''" C-m

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Final Setup
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# å›åˆ° Codex pane
tmux select-pane -t 0

echo "âœ… Compare session å»ºç«‹å®Œæˆï¼"
sleep 1

tmux attach-session -t "$SESSION_NAME"
